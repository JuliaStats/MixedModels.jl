<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Gradient and Hessian via ForwardDiff.jl · MixedModels</title><meta name="title" content="Gradient and Hessian via ForwardDiff.jl · MixedModels"/><meta property="og:title" content="Gradient and Hessian via ForwardDiff.jl · MixedModels"/><meta property="twitter:title" content="Gradient and Hessian via ForwardDiff.jl · MixedModels"/><meta name="description" content="Documentation for MixedModels."/><meta property="og:description" content="Documentation for MixedModels."/><meta property="twitter:description" content="Documentation for MixedModels."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="MixedModels logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MixedModels</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">MixedModels.jl Documentation</a></li><li><a class="tocitem" href="../constructors/">Model constructors</a></li><li><a class="tocitem" href="../optimization/">Details of the parameter estimation</a></li><li><a class="tocitem" href="../GaussHermite/">Normalized Gauss-Hermite Quadrature</a></li><li><a class="tocitem" href="../prediction/">Prediction and simulation in Mixed-Effects Models</a></li><li><a class="tocitem" href="../bootstrap/">Parametric bootstrap for mixed-effects models</a></li><li><a class="tocitem" href="../rankdeficiency/">Rank deficiency in mixed-effects models</a></li><li><a class="tocitem" href="../mime/">Alternative display and output formats</a></li><li class="is-active"><a class="tocitem" href>Gradient and Hessian via ForwardDiff.jl</a><ul class="internal"><li><a class="tocitem" href="#Exact-zero-at-optimum-for-trivial-models"><span>Exact zero at optimum for trivial models</span></a></li><li><a class="tocitem" href="#Approximate-zero-at-optimum-for-non-trivial-models"><span>Approximate zero at optimum for non trivial models</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Gradient and Hessian via ForwardDiff.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Gradient and Hessian via ForwardDiff.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaStats/MixedModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaStats/MixedModels.jl/blob/main/docs/src/derivatives.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Gradient-and-Hessian-via-ForwardDiff.jl"><a class="docs-heading-anchor" href="#Gradient-and-Hessian-via-ForwardDiff.jl">Gradient and Hessian via ForwardDiff.jl</a><a id="Gradient-and-Hessian-via-ForwardDiff.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Gradient-and-Hessian-via-ForwardDiff.jl" title="Permalink"></a></h1><p>Experimental support for computing the gradient and the Hessian of the objective function (i.e. negative twice the profiled log likelihood) via ForwardDiff.jl are provided as a package extension.</p><p>The core functionality is provided by defining appropriate methods for <code>ForwardDiff.gradient</code> and <code>ForwardDiff.hessian</code>:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ForwardDiff.gradient-Union{Tuple{T}, Tuple{LinearMixedModel{T}, Vector{T}}} where T" href="#ForwardDiff.gradient-Union{Tuple{T}, Tuple{LinearMixedModel{T}, Vector{T}}} where T"><code>ForwardDiff.gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ForwardDiff.gradient(model::LinearMixedModel)</code></pre><p>Evaluate the gradient of the objective function at the currently fitted parameter values.</p><div class="admonition is-warning" id="Large-allocations-c8806e57403f08e4"><header class="admonition-header">Large allocations<a class="admonition-anchor" href="#Large-allocations-c8806e57403f08e4" title="Permalink"></a></header><div class="admonition-body"><p>Most of MixedModels.jl relies strongly on in-place methods in order to minimize the amount of memory allocated. In addition to reducing the memory burden (especially for large models), this practice generally speeds up evaluation of the objective. In-place methods, however, generally do not play well with automatic differentiation. For the automatic differentiation support provided here, the developers instead implemented alternative, out-of-place methods. These will generally be slower and much more memory intensive, so use of this functionality is <strong>not</strong> recommended for large models.</p></div></div><div class="admonition is-warning" id="ForwardDiff.jl-support-is-experimental.-ef5a12879304b780"><header class="admonition-header">ForwardDiff.jl support is experimental.<a class="admonition-anchor" href="#ForwardDiff.jl-support-is-experimental.-ef5a12879304b780" title="Permalink"></a></header><div class="admonition-body"><p>Compatibility with ForwardDiff.jl is experimental. The precise structure, including function names and method definitions, is subject to change without being considered a breaking change. In particular, the exact set of parameters included is subject to change. The θ parameter is always included, but whether σ and/or the fixed effects should be included is currently still being decided.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/446d036cbed00dad0550d9ca954892053d0a2d54/ext/MixedModelsForwardDiffExt.jl#L61-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ForwardDiff.hessian-Union{Tuple{T}, Tuple{LinearMixedModel{T}, Vector{T}}} where T" href="#ForwardDiff.hessian-Union{Tuple{T}, Tuple{LinearMixedModel{T}, Vector{T}}} where T"><code>ForwardDiff.hessian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ForwardDiff.hessian(model::LinearMixedModel)</code></pre><p>Evaluate the Hessian of the objective function at the currently fitted parameter values.</p><div class="admonition is-warning" id="Large-allocations-c8806e57403f08e4"><header class="admonition-header">Large allocations<a class="admonition-anchor" href="#Large-allocations-c8806e57403f08e4" title="Permalink"></a></header><div class="admonition-body"><p>Most of MixedModels.jl relies strongly on in-place methods in order to minimize the amount of memory allocated. In addition to reducing the memory burden (especially for large models), this practice generally speeds up evaluation of the objective. In-place methods, however, generally do not play well with automatic differentiation. For the automatic differentiation support provided here, the developers instead implemented alternative, out-of-place methods. These will generally be slower and much more memory intensive, so use of this functionality is <strong>not</strong> recommended for large models.</p></div></div><div class="admonition is-warning" id="ForwardDiff.jl-support-is-experimental.-ef5a12879304b780"><header class="admonition-header">ForwardDiff.jl support is experimental.<a class="admonition-anchor" href="#ForwardDiff.jl-support-is-experimental.-ef5a12879304b780" title="Permalink"></a></header><div class="admonition-body"><p>Compatibility with ForwardDiff.jl is experimental. The precise structure, including function names and method definitions, is subject to change without being considered a breaking change. In particular, the exact set of parameters included is subject to change. The θ parameter is always included, but whether σ and/or the fixed effects should be included is currently still being decided.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/446d036cbed00dad0550d9ca954892053d0a2d54/ext/MixedModelsForwardDiffExt.jl#L75-L82">source</a></section></article><h2 id="Exact-zero-at-optimum-for-trivial-models"><a class="docs-heading-anchor" href="#Exact-zero-at-optimum-for-trivial-models">Exact zero at optimum for trivial models</a><a id="Exact-zero-at-optimum-for-trivial-models-1"></a><a class="docs-heading-anchor-permalink" href="#Exact-zero-at-optimum-for-trivial-models" title="Permalink"></a></h2><pre><code class="language-julia hljs">using MixedModels, ForwardDiff
fm1 = lmm(@formula(yield ~ 1 + (1|batch)), MixedModels.dataset(:dyestuff2))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Linear mixed model fit by maximum likelihood
 yield ~ 1 + (1 | batch)
   logLik   -2 logLik     AIC       AICc        BIC    
   -81.4365   162.8730   168.8730   169.7961   173.0766

Variance components:
            Column   Variance Std.Dev.
batch    (Intercept)   0.00000 0.00000
Residual              13.34610 3.65323
 Number of obs: 30; levels of grouping factors: 6

  Fixed-effects parameters:
───────────────────────────────────────────────
              Coef.  Std. Error     z  Pr(&gt;|z|)
───────────────────────────────────────────────
(Intercept)  5.6656    0.666986  8.49    &lt;1e-16
───────────────────────────────────────────────</code></pre><pre><code class="language-julia hljs">ForwardDiff.gradient(fm1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Float64}:
 0.0</code></pre><pre><code class="language-julia hljs">ForwardDiff.hessian(fm1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×1 Matrix{Float64}:
 28.76868076413998</code></pre><h2 id="Approximate-zero-at-optimum-for-non-trivial-models"><a class="docs-heading-anchor" href="#Approximate-zero-at-optimum-for-non-trivial-models">Approximate zero at optimum for non trivial models</a><a id="Approximate-zero-at-optimum-for-non-trivial-models-1"></a><a class="docs-heading-anchor-permalink" href="#Approximate-zero-at-optimum-for-non-trivial-models" title="Permalink"></a></h2><pre><code class="language-julia hljs">fm2 = lmm(@formula(reaction ~ 1 + days + (1+days|subj)), MixedModels.dataset(:sleepstudy))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Linear mixed model fit by maximum likelihood
 reaction ~ 1 + days + (1 + days | subj)
   logLik   -2 logLik     AIC       AICc        BIC    
  -875.9697  1751.9393  1763.9393  1764.4249  1783.0971

Variance components:
            Column    Variance Std.Dev.   Corr.
subj     (Intercept)  565.51067 23.78047
         days          32.68212  5.71683 +0.08
Residual              654.94145 25.59182
 Number of obs: 180; levels of grouping factors: 18

  Fixed-effects parameters:
──────────────────────────────────────────────────
                Coef.  Std. Error      z  Pr(&gt;|z|)
──────────────────────────────────────────────────
(Intercept)  251.405      6.63226  37.91    &lt;1e-99
days          10.4673     1.50224   6.97    &lt;1e-11
──────────────────────────────────────────────────</code></pre><pre><code class="language-julia hljs">ForwardDiff.gradient(fm2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Float64}:
 -7.769368957610823e-5
  0.0010019612167546654
  7.373940113097888e-5</code></pre><pre><code class="language-julia hljs">ForwardDiff.hessian(fm2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×3 Matrix{Float64}:
 45.4126    35.9366    6.35492
 35.9366   465.74    203.992
  6.35492  203.992   963.952</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mime/">« Alternative display and output formats</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 22 July 2025 21:01">Tuesday 22 July 2025</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
