<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parametric bootstrap for mixed-effects models · MixedModels</title><meta name="title" content="Parametric bootstrap for mixed-effects models · MixedModels"/><meta property="og:title" content="Parametric bootstrap for mixed-effects models · MixedModels"/><meta property="twitter:title" content="Parametric bootstrap for mixed-effects models · MixedModels"/><meta name="description" content="Documentation for MixedModels."/><meta property="og:description" content="Documentation for MixedModels."/><meta property="twitter:description" content="Documentation for MixedModels."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="MixedModels logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MixedModels</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">MixedModels.jl Documentation</a></li><li><a class="tocitem" href="../constructors/">Model constructors</a></li><li><a class="tocitem" href="../optimization/">Details of the parameter estimation</a></li><li><a class="tocitem" href="../GaussHermite/">Normalized Gauss-Hermite Quadrature</a></li><li><a class="tocitem" href="../prediction/">Prediction and simulation in Mixed-Effects Models</a></li><li class="is-active"><a class="tocitem" href>Parametric bootstrap for mixed-effects models</a><ul class="internal"><li><a class="tocitem" href="#The-parametric-bootstrap"><span>The parametric bootstrap</span></a></li><li><a class="tocitem" href="#Reduced-Precision-Bootstrap"><span>Reduced Precision Bootstrap</span></a></li><li><a class="tocitem" href="#Distributed-Computing-and-the-Bootstrap"><span>Distributed Computing and the Bootstrap</span></a></li></ul></li><li><a class="tocitem" href="../rankdeficiency/">Rank deficiency in mixed-effects models</a></li><li><a class="tocitem" href="../mime/">Alternative display and output formats</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Parametric bootstrap for mixed-effects models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parametric bootstrap for mixed-effects models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaStats/MixedModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaStats/MixedModels.jl/blob/main/docs/src/bootstrap.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Parametric-bootstrap-for-mixed-effects-models"><a class="docs-heading-anchor" href="#Parametric-bootstrap-for-mixed-effects-models">Parametric bootstrap for mixed-effects models</a><a id="Parametric-bootstrap-for-mixed-effects-models-1"></a><a class="docs-heading-anchor-permalink" href="#Parametric-bootstrap-for-mixed-effects-models" title="Permalink"></a></h1><p>Julia is well-suited to implementing bootstrapping and other simulation-based methods for statistical models. The <code>parametricbootstrap</code> function in the <a href="https://github.com/JuliaStats/MixedModels.jl">MixedModels package</a> provides an efficient parametric bootstrap for mixed-effects models.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModels.parametricbootstrap" href="#MixedModels.parametricbootstrap"><code>MixedModels.parametricbootstrap</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parametricbootstrap([rng::AbstractRNG], nsamp::Integer, m::MixedModel{T}, ftype=T;
    β = fixef(m), σ = m.σ, θ = m.θ, progress=true, optsum_overrides=(;))</code></pre><p>Perform <code>nsamp</code> parametric bootstrap replication fits of <code>m</code>, returning a <code>MixedModelBootstrap</code>.</p><p>The default random number generator is <code>Random.GLOBAL_RNG</code>.</p><p><code>ftype</code> can be used to store the computed bootstrap values in a lower precision. <code>ftype</code> is not a named argument because named arguments are not used in method dispatch and thus specialization. In other words, having <code>ftype</code> as a positional argument has some potential performance benefits.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>β</code>, <code>σ</code>, and <code>θ</code> are the values of <code>m</code>&#39;s parameters for simulating the responses.</li><li><code>σ</code> is only valid for <code>LinearMixedModel</code> and <code>GeneralizedLinearMixedModel</code> for</li></ul><p>families with a dispersion parameter.</p><ul><li><code>progress</code> controls whether the progress bar is shown. Note that the progress</li></ul><p>bar is automatically disabled for non-interactive (i.e. logging) contexts.</p><ul><li><code>optsum_overrides</code> is used to override values of <a href="../api/#MixedModels.OptSummary">OptSummary</a> in the models</li></ul><p>fit during the bootstrapping process. For example, <code>optsum_overrides=(;ftol_rel=1e-08)</code> reduces the convergence criterion, which can greatly speed up the bootstrap fits. Taking advantage of this speed up to increase <code>n</code> can often lead to better estimates of coverage intervals.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>All coefficients are bootstrapped. In the rank deficient case, the inestimatable coefficients are treated as -0.0 in the simulations underlying the bootstrap, which will generally result in their estimate from the simulated data also being being inestimable and thus set to -0.0. <strong>However this behavior may change in future releases to explicitly drop the extraneous columns before simulation and thus not include their estimates in the bootstrap result.</strong></p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/f03c65b8434cba111240427a974011b9ca08d4bc/src/bootstrap.jl#L178-L211">source</a></section></article><h2 id="The-parametric-bootstrap"><a class="docs-heading-anchor" href="#The-parametric-bootstrap">The parametric bootstrap</a><a id="The-parametric-bootstrap-1"></a><a class="docs-heading-anchor-permalink" href="#The-parametric-bootstrap" title="Permalink"></a></h2><p><a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">Bootstrapping</a> is a family of procedures for generating sample values of a statistic, allowing for visualization of the distribution of the statistic or for inference from this sample of values.</p><p>A <em>parametric bootstrap</em> is used with a parametric model, <code>m</code>, that has been fit to data. The procedure is to simulate <code>n</code> response vectors from <code>m</code> using the estimated parameter values and refit <code>m</code> to these responses in turn, accumulating the statistics of interest at each iteration.</p><p>The parameters of a <code>LinearMixedModel</code> object are the fixed-effects parameters, <code>β</code>, the standard deviation, <code>σ</code>, of the per-observation noise, and the covariance parameter, <code>θ</code>, that defines the variance-covariance matrices of the random effects.</p><p>For example, a simple linear mixed-effects model for the <code>Dyestuff</code> data in the <a href="http://github.com/lme4/lme4"><code>lme4</code></a> package for <a href="https://www.r-project.org"><code>R</code></a> is fit by</p><pre><code class="language-julia hljs">using DataFrames
using Gadfly          # plotting package
using MixedModels
using Random</code></pre><pre><code class="language-julia hljs">dyestuff = MixedModels.dataset(:dyestuff)
m1 = fit(MixedModel, @formula(yield ~ 1 + (1 | batch)), dyestuff)</code></pre><table><tr><th align="left"></th><th align="right">Est.</th><th align="right">SE</th><th align="right">z</th><th align="right">p</th><th align="right">σ_batch</th></tr><tr><td align="left">&#40;Intercept&#41;</td><td align="right">1527.5000</td><td align="right">17.6946</td><td align="right">86.33</td><td align="right">&lt;1e-99</td><td align="right">37.2603</td></tr><tr><td align="left">Residual</td><td align="right">49.5101</td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td></tr></table>
<p>To bootstrap the model parameters, first initialize a random number generator then create a bootstrap sample and extract the <code>tbl</code> property, which is a <code>Table</code> - a lightweight dataframe-like object.</p><pre><code class="language-julia hljs">const rng = MersenneTwister(1234321);
samp = parametricbootstrap(rng, 10_000, m1);
tbl = samp.tbl</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Table with 5 columns and 10000 rows:
      obj      β1       σ        σ1        θ1
    ┌────────────────────────────────────────────────
 1  │ 339.022  1509.13  67.4315  14.312    0.212245
 2  │ 322.689  1538.08  47.9831  25.5673   0.53284
 3  │ 324.002  1508.02  50.1346  21.7622   0.434076
 4  │ 331.887  1538.47  53.2238  41.0559   0.771383
 5  │ 317.771  1520.62  45.2975  19.1802   0.423428
 6  │ 315.181  1536.94  36.7556  49.1832   1.33812
 7  │ 333.641  1519.88  53.8161  46.712    0.867993
 8  │ 325.729  1528.43  47.8989  37.6367   0.785752
 9  │ 311.601  1497.46  41.4     15.1257   0.365355
 10 │ 335.244  1532.65  64.616   0.0       0.0
 11 │ 327.935  1552.54  57.2036  0.485275  0.00848329
 12 │ 323.861  1519.28  49.355   24.3703   0.493776
 13 │ 332.736  1509.04  59.6272  18.2905   0.306747
 14 │ 328.243  1531.7   51.5431  32.4743   0.630042
 15 │ 336.186  1536.17  64.0205  15.243    0.238096
 16 │ 329.468  1526.42  58.6856  0.0       0.0
 17 │ 320.086  1517.67  43.218   35.9663   0.832207
 ⋮  │    ⋮        ⋮        ⋮        ⋮          ⋮</code></pre><p>A density plot of the estimates of <code>σ</code>, the residual standard deviation, can be created as</p><pre><code class="language-julia hljs">plot(x = tbl.σ, Geom.density, Guide.xlabel(&quot;Parametric bootstrap estimates of σ&quot;))</code></pre><img src="0e5ed0a8.svg" alt="Example block output"/><p>or, for the intercept parameter</p><pre><code class="language-julia hljs">plot(x = tbl.β1, Geom.density, Guide.xlabel(&quot;Parametric bootstrap estimates of β₁&quot;))</code></pre><img src="d63695f5.svg" alt="Example block output"/><p>A density plot of the estimates of the standard deviation of the random effects is obtained as</p><pre><code class="language-julia hljs">plot(x = tbl.σ1, Geom.density,
    Guide.xlabel(&quot;Parametric bootstrap estimates of σ₁&quot;))</code></pre><img src="720d093d.svg" alt="Example block output"/><p>Notice that this density plot has a spike, or mode, at zero. Although this mode appears to be diffuse, this is an artifact of the way that density plots are created. In fact, it is a pulse, as can be seen from a histogram.</p><pre><code class="language-julia hljs">plot(x = tbl.σ1, Geom.histogram,
    Guide.xlabel(&quot;Parametric bootstrap estimates of σ₁&quot;))</code></pre><img src="f2ca069a.svg" alt="Example block output"/><p>The bootstrap sample can be used to generate intervals that cover a certain percentage of the bootstrapped values. We refer to these as &quot;coverage intervals&quot;, similar to a confidence interval. The shortest such intervals, obtained with the <code>shortestcovint</code> extractor, correspond to a highest posterior density interval in Bayesian inference.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModels.shortestcovint" href="#MixedModels.shortestcovint"><code>MixedModels.shortestcovint</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">shortestcovint(v, level = 0.95)</code></pre><p>Return the shortest interval containing <code>level</code> proportion of the values of <code>v</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/f03c65b8434cba111240427a974011b9ca08d4bc/src/bootstrap.jl#L475-L479">source</a></section><section><div><pre><code class="language-julia hljs">shortestcovint(bsamp::MixedModelFitCollection, level = 0.95)</code></pre><p>Return the shortest interval containing <code>level</code> proportion for each parameter from <code>bsamp.allpars</code>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Currently, correlations that are systematically zero are included in the the result. This may change in a future release without being considered a breaking change.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaStats/MixedModels.jl/blob/f03c65b8434cba111240427a974011b9ca08d4bc/src/bootstrap.jl#L495-L504">source</a></section></article><p>We generate these directly from the original bootstrap object:</p><pre><code class="language-julia hljs">Table(shortestcovint(samp))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Table with 5 columns and 3 rows:
     type  group     names        lower    upper
   ┌──────────────────────────────────────────────
 1 │ β     missing   (Intercept)  1492.54  1561.34
 2 │ σ     batch     (Intercept)  0.0      54.7043
 3 │ σ     residual  missing      35.4909  63.0209</code></pre><p>A value of zero for the standard deviation of the random effects is an example of a <em>singular</em> covariance. It is easy to detect the singularity in the case of a scalar random-effects term. However, it is not as straightforward to detect singularity in vector-valued random-effects terms.</p><p>For example, if we bootstrap a model fit to the <code>sleepstudy</code> data</p><pre><code class="language-julia hljs">sleepstudy = MixedModels.dataset(:sleepstudy)
contrasts = Dict(:subj =&gt; Grouping())
m2 = let f = @formula reaction ~ 1+days+(1+days|subj)
    fit(MixedModel, f, sleepstudy; contrasts)
end</code></pre><table><tr><th align="left"></th><th align="right">Est.</th><th align="right">SE</th><th align="right">z</th><th align="right">p</th><th align="right">σ_subj</th></tr><tr><td align="left">&#40;Intercept&#41;</td><td align="right">251.4051</td><td align="right">6.6323</td><td align="right">37.91</td><td align="right">&lt;1e-99</td><td align="right">23.7805</td></tr><tr><td align="left">days</td><td align="right">10.4673</td><td align="right">1.5022</td><td align="right">6.97</td><td align="right">&lt;1e-11</td><td align="right">5.7168</td></tr><tr><td align="left">Residual</td><td align="right">25.5918</td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td></tr></table>
<pre><code class="language-julia hljs">samp2 = parametricbootstrap(rng, 10_000, m2);
tbl2 = samp2.tbl</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Table with 10 columns and 10000 rows:
      obj      β1       β2       σ        σ1       σ2       ρ1          ⋯
    ┌────────────────────────────────────────────────────────────────────
 1  │ 1762.97  262.397  10.5117  26.2691  24.8119  6.86013  -0.335778   ⋯
 2  │ 1761.29  252.753  10.9396  27.4071  15.4139  5.27725  0.191491    ⋯
 3  │ 1760.12  244.773  14.1153  27.7064  18.1545  3.77585  0.501708    ⋯
 4  │ 1728.02  256.885  9.90894  24.3406  22.8058  4.62388  -0.125449   ⋯
 5  │ 1739.12  241.968  12.9145  26.1862  8.27936  5.21775  0.596437    ⋯
 6  │ 1779.57  249.305  11.2124  27.2767  24.9131  7.15134  0.220329    ⋯
 7  │ 1765.37  240.264  10.7107  27.3333  25.2447  4.18552  0.613865    ⋯
 8  │ 1727.31  253.876  9.17989  24.8219  22.5107  3.72496  -0.167116   ⋯
 9  │ 1746.59  264.797  10.315   25.6272  21.3612  5.06129  0.310146    ⋯
 10 │ 1755.46  256.464  10.4106  25.4156  35.3511  4.95412  -0.195481   ⋯
 11 │ 1773.51  260.967  11.0385  28.4814  21.2083  4.39551  1.0         ⋯
 12 │ 1690.61  258.852  10.3472  21.0322  26.1479  4.99185  -0.0787605  ⋯
 13 │ 1742.15  251.951  8.57777  24.3526  28.4102  5.7392   0.139818    ⋯
 14 │ 1733.94  260.473  9.68852  24.1964  20.8341  6.17182  0.377655    ⋯
 15 │ 1781.65  249.654  11.0241  29.552   11.5514  5.28092  0.498551    ⋯
 16 │ 1790.19  247.356  9.46489  28.0847  31.4617  6.25443  0.0073141   ⋯
 17 │ 1740.19  245.537  11.243   25.5401  14.8452  5.53331  0.258929    ⋯
 ⋮  │    ⋮        ⋮        ⋮        ⋮        ⋮        ⋮         ⋮       ⋱</code></pre><p>the singularity can be exhibited as a standard deviation of zero or as a correlation of <span>$\pm1$</span>.</p><pre><code class="language-julia hljs">shortestcovint(samp2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{NamedTuple{(:type, :group, :names, :lower, :upper)}}:
 (type = &quot;β&quot;, group = missing, names = &quot;(Intercept)&quot;, lower = 238.5828600121617, upper = 263.89217662125895)
 (type = &quot;β&quot;, group = missing, names = &quot;days&quot;, lower = 7.539638299557727, upper = 13.368161276142704)
 (type = &quot;σ&quot;, group = &quot;subj&quot;, names = &quot;(Intercept)&quot;, lower = 10.507876051388921, upper = 33.218443046181676)
 (type = &quot;σ&quot;, group = &quot;subj&quot;, names = &quot;days&quot;, lower = 3.024936712829588, upper = 7.675241393755667)
 (type = &quot;ρ&quot;, group = &quot;subj&quot;, names = &quot;(Intercept), days&quot;, lower = -0.40535765760216863, upper = 1.0)
 (type = &quot;σ&quot;, group = &quot;residual&quot;, names = missing, lower = 22.656763019290786, upper = 28.43122140376578)</code></pre><p>A histogram of the estimated correlations from the bootstrap sample has a spike at <code>+1</code>.</p><pre><code class="language-julia hljs">plot(x = tbl2.ρ1, Geom.histogram,
    Guide.xlabel(&quot;Parametric bootstrap samples of correlation of random effects&quot;))</code></pre><img src="dc3ffbd1.svg" alt="Example block output"/><p>or, as a count,</p><pre><code class="language-julia hljs">count(tbl2.ρ1 .≈ 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306</code></pre><p>Close examination of the histogram shows a few values of <code>-1</code>.</p><pre><code class="language-julia hljs">count(tbl2.ρ1 .≈ -1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2</code></pre><p>Furthermore there are even a few cases where the estimate of the standard deviation of the random effect for the intercept is zero.</p><pre><code class="language-julia hljs">count(tbl2.σ1 .≈ 0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5</code></pre><p>There is a general condition to check for singularity of an estimated covariance matrix or matrices in a bootstrap sample. The parameter optimized in the estimation is <code>θ</code>, the relative covariance parameter. Some of the elements of this parameter vector must be non-negative and, when one of these components is approximately zero, one of the covariance matrices will be singular.</p><p>The <code>issingular</code> method for a <code>MixedModel</code> object that tests if a parameter vector <code>θ</code> corresponds to a boundary or singular fit.</p><p>This operation is encapsulated in a method for the <code>issingular</code> function.</p><pre><code class="language-julia hljs">count(issingular(samp2))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">313</code></pre><h2 id="Reduced-Precision-Bootstrap"><a class="docs-heading-anchor" href="#Reduced-Precision-Bootstrap">Reduced Precision Bootstrap</a><a id="Reduced-Precision-Bootstrap-1"></a><a class="docs-heading-anchor-permalink" href="#Reduced-Precision-Bootstrap" title="Permalink"></a></h2><p><code>parametricbootstrap</code> accepts an optional keyword argument <code>optsum_overrides</code>, which can be used to override the convergence criteria for bootstrap replicates. One possibility is setting <code>ftol_rel=1e-8</code>, i.e., considering the model converged when the relative change in the objective between optimizer iterations is smaller than 0.00000001. This threshold corresponds approximately to the precision from treating the value of the objective as a single precision (<code>Float32</code>) number, while not changing the precision of the intermediate computations. The resultant loss in precision will generally be smaller than the variation that the bootstrap captures, but can greatly speed up the fitting process for each replicates, especially for large models. More directly, lowering the fit quality for each replicate will reduce the quality of each replicate, but this may be more than compensated for by the ability to fit a much larger number of replicates in the same time.</p><pre><code class="language-julia hljs">t = @timed parametricbootstrap(MersenneTwister(42), 1000, m2; progress=false)
t.time</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.710958977</code></pre><pre><code class="language-julia hljs">optsum_overrides = (; ftol_rel=1e-8)
t = @timed parametricbootstrap(MersenneTwister(42), 1000, m2; optsum_overrides, progress=false)
t.time</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.636908093</code></pre><h2 id="Distributed-Computing-and-the-Bootstrap"><a class="docs-heading-anchor" href="#Distributed-Computing-and-the-Bootstrap">Distributed Computing and the Bootstrap</a><a id="Distributed-Computing-and-the-Bootstrap-1"></a><a class="docs-heading-anchor-permalink" href="#Distributed-Computing-and-the-Bootstrap" title="Permalink"></a></h2><p>Earlier versions of MixedModels.jl supported a multi-threaded bootstrap via the <code>use_threads</code> keyword argument. However, with improved BLAS multithreading, the Julia-level threads often wound up competing with the BLAS threads, leading to no improvement or even a worsening of performance when <code>use_threads=true</code>. Nonetheless, the bootstrap is a classic example of an <a href="https://en.wikipedia.org/wiki/Embarrassingly_parallel">embarrassingly parallel</a> problem and so we provide a few convenience methods for combining results computed separately. In particular, there are <code>vcat</code> and an optimized <code>reduce(::typeof(vcat))</code> methods for <code>MixedModelBootstrap</code> objects. For computers with many processors (as opposed to a single processor with several cores) or for computing clusters, these provide a convenient way to split the computation across nodes.</p><pre><code class="language-julia hljs">using Distributed
# you already have 1 proc by default, so add the number of additional cores with `addprocs`
# you need at least as many RNGs as cores you want to use in parallel
# but you shouldn&#39;t use all of your cores because nested within this
# is the multithreading of the linear algebra
# addprocs(1)
@info &quot;Currently using $(nprocs()) processors total and $(nworkers()) for work&quot;

# Load the necessary packages on all workers
# For clusters, you will also need to make sure that the Julia
# environment (Project.toml) is set up and activated on each worker.
@everywhere begin
    using ProgressMeter
    using MixedModels
end
# copy everything to workers
@showprogress for w in workers()
    remotecall_fetch(() -&gt; coefnames(m2), w)
end

# split the replicates across the workers
# this rounds down, so if the number of workers doesn&#39;t divide the
# number of replicates, you&#39;ll be a few replicates short!
n_replicates = 1000
n_rep_per_worker = n_replicates ÷ nworkers()
# NB: You need a different seed/RNG for each worker otherwise you will
# have copies of the same replicates and not independent replicates!
pb_map = @showprogress pmap(MersenneTwister.(1:nworkers())) do rng
    parametricbootstrap(rng, n_rep_per_worker, m2; optsum_overrides)
end;

# get rid of all the workers
# rmprocs(workers())

confint(reduce(vcat, pb_map))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DictTable with 2 columns and 6 rows:
 par   lower      upper
 ────┬───────────────────
 β1  │ 236.59     264.035
 β2  │ 7.75279    13.3734
 ρ1  │ -0.424371  1.0
 σ   │ 22.4485    28.2745
 σ1  │ 10.6217    32.5576
 σ2  │ 3.18136    7.74161</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../prediction/">« Prediction and simulation in Mixed-Effects Models</a><a class="docs-footer-nextpage" href="../rankdeficiency/">Rank deficiency in mixed-effects models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Friday 8 November 2024 05:03">Friday 8 November 2024</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
