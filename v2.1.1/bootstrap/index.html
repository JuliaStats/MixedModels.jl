<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parametric bootstrap for linear mixed-effects models · MixedModels</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="MixedModels logo"/></a><h1>MixedModels</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">MixedModels.jl Documentation</a></li><li><a class="toctext" href="../constructors/">Model constructors</a></li><li><a class="toctext" href="../optimization/">Details of the parameter estimation</a></li><li><a class="toctext" href="../GaussHermite/">Normalized Gauss-Hermite Quadrature</a></li><li class="current"><a class="toctext" href>Parametric bootstrap for linear mixed-effects models</a><ul class="internal"><li><a class="toctext" href="#The-parametric-bootstrap-1">The parametric bootstrap</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Parametric bootstrap for linear mixed-effects models</a></li></ul><a class="edit-page" href="https://github.com/dmbates/MixedModels.jl/blob/master/docs/src/bootstrap.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Parametric bootstrap for linear mixed-effects models</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Parametric-bootstrap-for-linear-mixed-effects-models-1" href="#Parametric-bootstrap-for-linear-mixed-effects-models-1">Parametric bootstrap for linear mixed-effects models</a></h1><p>Julia is well-suited to implementing bootstrapping and other simulation-based methods for statistical models. The <code>parametricbootstrap</code> function in the <a href="https://github.com/dmbates/MixedModels.jl">MixedModels package</a> provides an efficient parametric bootstrap for linear mixed-effects models.</p><h2><a class="nav-anchor" id="The-parametric-bootstrap-1" href="#The-parametric-bootstrap-1">The parametric bootstrap</a></h2><p><a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">Bootstrapping</a> is a family of procedures for generating sample values of a statistic, allowing for visualization of the distribution of the statistic or for inference from this sample of values.</p><p>A <em>parametric bootstrap</em> is used with a parametric model, <code>m</code>, that has been fitted to data. The procedure is to simulate <code>n</code> response vectors from <code>m</code> using the estimated parameter values and refit <code>m</code> to these responses in turn, accumulating the statistics of interest at each iteration.</p><p>The parameters of a <code>LinearMixedModel</code> object are the fixed-effects parameters, <code>β</code>, the standard deviation, <code>σ</code>, of the per-observation noise, and the covariance parameter, <code>θ</code>, that defines the variance-covariance matrices of the random effects.</p><p>For example, a simple linear mixed-effects model for the <code>Dyestuff</code> data in the <a href="http://github.com/lme4/lme4"><code>lme4</code></a> package for <a href="https://www.r-project.org"><code>R</code></a> is fit by</p><pre><code class="language-julia">using DataFrames, Gadfly, MixedModels, Random, RData
testdir = normpath(joinpath(dirname(pathof(MixedModels)), &quot;..&quot;, &quot;test&quot;));
const dat = Dict(Symbol(k)=&gt;v for (k,v) in load(joinpath(testdir, &quot;dat.rda&quot;)));</code></pre><pre><code class="language-julia">ds = names!(dat[:Dyestuff], [:Batch, :Yield])  # the Dyestuff data
m1 = fit!(LinearMixedModel(@formula(Yield ~ 1 + (1 | Batch)), ds))</code></pre><pre><code class="language-none">Linear mixed model fit by maximum likelihood
 Yield ~ 1 + (1 | Batch)
   logLik   -2 logLik     AIC        BIC    
 -163.66353  327.32706  333.32706  337.53065

Variance components:
              Column    Variance  Std.Dev. 
 Batch    (Intercept)  1388.3334 37.260347
 Residual              2451.2500 49.510100
 Number of obs: 30; levels of grouping factors: 6

  Fixed-effects parameters:
──────────────────────────────────────────────────
             Estimate  Std.Error  z value  P(&gt;|z|)
──────────────────────────────────────────────────
(Intercept)    1527.5    17.6946   86.326   &lt;1e-99
──────────────────────────────────────────────────</code></pre><p>To bootstrap the model parameters, we first initialize a random number generator</p><pre><code class="language-julia">rng = MersenneTwister(1234321);</code></pre><p>then create a bootstrap sample</p><pre><code class="language-julia">samp = parametricbootstrap(rng, 100_000, m1, (:σ, :β, :θ))</code></pre><pre><code class="language-none">Table with 3 columns and 100000 rows:
      σ        β          θ
    ┌─────────────────────────────────
 1  │ 67.4315  [1509.13]  [0.212245]
 2  │ 47.9831  [1538.08]  [0.532841]
 3  │ 50.1346  [1508.02]  [0.434076]
 4  │ 53.2238  [1538.47]  [0.771382]
 5  │ 45.2975  [1520.62]  [0.423428]
 6  │ 36.7556  [1536.94]  [1.33812]
 7  │ 53.8161  [1519.88]  [0.867993]
 8  │ 47.8989  [1528.43]  [0.785752]
 9  │ 41.4     [1497.46]  [0.365355]
 10 │ 64.616   [1532.65]  [0.0]
 11 │ 57.2036  [1552.54]  [0.00848485]
 12 │ 49.355   [1519.28]  [0.493776]
 13 │ 59.6272  [1509.04]  [0.306747]
 14 │ 51.5431  [1531.7]   [0.630042]
 15 │ 64.0205  [1536.17]  [0.238096]
 16 │ 58.6856  [1526.42]  [0.0]
 17 │ 43.218   [1517.67]  [0.832206]
 ⋮  │    ⋮         ⋮           ⋮</code></pre><p>The results from the sampling are returned as a <code>Table</code>, as defined in the <code>TypedTables.jl</code> package. Both <span>$\beta$</span> and <span>$\theta$</span> are vectors - in this case one-dimensional vectors.  The <code>first</code> and <code>last</code> functions are useful for extracting individual elements from the sampled vectors.</p><p>Notice that, for some samples, the estimated value of <span>$\theta$</span> is <code>[0.0]</code>.  In fact, this is the case for about about 10% of all the samples.</p><pre><code class="language-julia">sum(iszero, samp.θ)</code></pre><pre><code class="language-none">10090</code></pre><p>A density plot of the bootstrapped values of <code>σ</code> shows a slightly skewed but unimodal distribution</p><pre><code class="language-julia">plot(x=samp.σ, Geom.density, Guide.xlabel(&quot;Parametric bootstrap estimates of σ&quot;))</code></pre><p><img src="../assets/bootstrap_6_1.svg" alt/></p><p>but a density plot of the bootstrap estimates of <span>$\theta_1$</span>, or of <span>$\sigma_1=\theta_1 \cdot \sigma$</span></p><pre><code class="language-julia">plot(x=first.(samp.θ), Geom.density, Guide.xlabel(&quot;Parametric bootstrap estimates of θ₁&quot;))</code></pre><p><img src="../assets/bootstrap_7_1.svg" alt/></p><pre><code class="language-julia">plot(x=first.(samp.θ) .* samp.σ, Geom.density, Guide.xlabel(&quot;Parametric bootstrap estimates of σ₁&quot;))</code></pre><p><img src="../assets/bootstrap_8_1.svg" alt/></p><p>has a mode at zero.  Although this mode shows up as being diffuse, this is an artifact of the way that density plots are created.  In fact, it is a pulse, as can be seen from a histogram.</p><pre><code class="language-julia">plot(x=first.(samp.θ).*samp.σ, Geom.histogram, Guide.xlabel(&quot;Parametric bootstrap estimates of σ₁&quot;))</code></pre><p><img src="../assets/bootstrap_9_1.svg" alt/></p><footer><hr/><a class="previous" href="../GaussHermite/"><span class="direction">Previous</span><span class="title">Normalized Gauss-Hermite Quadrature</span></a></footer></article></body></html>
